(function(e){e.fn.insertAt=function(t,n){return this.each(function(){var r=e(this).children().size();if(t<=0){e(this).prepend(n)}else if(t>=r){e(this).append(n)}else{e(this).children().eq(t).before(n)}})};e.fn.widget=function(t){if(e.fn.widget.methods[t]){return e.fn.widget.methods[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return e.fn.widget.methods.init.apply(this,arguments)}else{e.error('The method "'+t+'" is not in the plug-in widget')}};var t={ICON_CLOSE:"icon-remove",ICON_RESIZE_FULL:"icon-resize-full",ICON_RESIZE_SMALL:"icon-resize-small",ICON_COLLAPSE:"icon-chevron-up",ICON_EXPAND:"icon-chevron-down"};e.fn.widget.methods={init:function(n){return this.each(function(){var r=e(this);var i={header:true,title:"",icon:null,contentTransparent:false,fullscreen:true,collapse:true,close:true,extras:[],onCreate:function(e){},onExpand:function(e){},onCollapse:function(e){},onClose:function(e){},onFullscreen:function(e){},onFullscreenExit:function(e){}};var s=e.extend({},i,r.data());s=e.extend({},s,n);var o=function(){e(document).trigger("resize");e("body,html").animate({scrollTop:e(".widget-container").data("scroll")},200)};if(s.contentTransparent==true){r.addClass("widget-content-transparent")}if(s.header==true){var u=e('<div class="widget-header"></div>');if(s.icon!=null){u.append('<i class="'+s.icon+'"></i>')}u.append("<h3>"+s.title+"</h3>");var a=e('<div class="options"></div>');var f=e("body .widget-container");if(s.fullscreen==true&&f.length){a.append('<i class="btn-fullscreen '+t.ICON_RESIZE_FULL+'"></i>')}if(s.collapse==true){a.append('<i class="btn-collapse '+t.ICON_COLLAPSE+'"></i>')}if(s.close==true){a.append('<i class="btn-close '+t.ICON_CLOSE+'"></i>')}if(e.isArray(s.extras)==true){e.each(s.extras,function(t,n){s.extras[t]=e.extend({},{icon:null,index:0,onClick:function(e){}},n);var r=s.extras[t];var i=e('<i class="'+r.icon+'"></i>');if(e.isFunction(r.onClick)){i.bind("click",r.onClick)}a.insertAt(r.index,i)})}u.append(a);r.prepend(u);var l=a.find('i[class*="btn-fullscreen"]');var c=a.find('i[class*="btn-collapse"]');var h=a.find('i[class*="btn-close"]');if(h.length){h.bind("click",function(t){r.hide("fade",100,function(){var t=r.parents('div[class*="row"]').eq(0);if(t.find(".widget:visible").length==0){t.hide()}if(e.isFunction(s.onClose)){s.onClose.apply(r)}})})}if(l.length){l.toggle(function(n){r.data("index",r.index());e(".widget-container").data("scroll",e(window).scrollTop());if(h.length){h.hide()}if(c.length){c.hide()}e(this).removeClass(t.ICON_RESIZE_FULL).addClass(t.ICON_RESIZE_SMALL);var i=e(".widget-container").parent();e(".widget-container").hide();var u=['<div class="row-fluid widget-fullscreen">','<div class="span12 target"></div>',"</div>"].join("");r.data("parent",r.parent());var a=e(u);a.find(".target").append(r);i.append(a);a.show("fade",1e3);setTimeout(o,100);if(e.isFunction(s.onFullscreen)){s.onFullscreen.apply(r)}},function(n){if(h.length){h.show()}if(c.length){c.show()}e(this).removeClass(t.ICON_RESIZE_SMALL).addClass(t.ICON_RESIZE_FULL);var i=r.data("parent");i.insertAt(r.data("index"),r);e(".widget-fullscreen").remove();e(".widget-container").show("fade",1e3);setTimeout(o,100);if(e.isFunction(s.onFullscreenExit)){s.onFullscreenExit.apply(r)}})}if(c.length){c.toggle(function(n){if(l.length){l.hide()}r.find(".widget-content").animate({height:"hide"},200,"linear",function(){});e(this).removeClass(t.ICON_COLLAPSE).addClass(t.ICON_EXPAND);if(e.isFunction(s.onCollapse)){s.onCollapse.apply(r)}},function(n){if(l.length){l.show()}r.find(".widget-content").animate({height:"show"},200,"linear",function(){setTimeout(o,0)});e(this).removeClass(t.ICON_EXPAND).addClass(t.ICON_COLLAPSE);if(e.isFunction(s.onExpand)){s.onExpand.apply(r)}})}}if(e.isFunction(s.onCreate)){s.onCreate.apply(r)}})}}})(jQuery)